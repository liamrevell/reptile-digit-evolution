getwd()
setwd("GitHub/reptile-digit-evolution/")
list.files()
load("workspace.RData")
remotes::install_github("liamrevell/phytools")
ancr(toes_mk)
library(phytools)
ancr(toes_mk)
ancr(toes_hrm)
-
-
)
fore_digits<-setNames(as.factor(squamate.data$FDp1-1),rownames(squamate.data))
fore_digits<-setNames(as.factor(squamate.data$FDp1-1),rownames(squamate.data))
fingers_mk<-fitHRM(squamate.tree,fore_digits,umbral=TRUE,ncat=1,niter=10,
parallel=TRUE,ncores=10,pi="fitzjohn",ordered=TRUE,order=levels(fore_digits),
lik.func="pruning",logscale=TRUE)
options(scipen=6)
plot(fingers_mk,signif=4)
plot(as.Qmatrix(fingers_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE)
ancr(fingers_mk)
fingers_hrm<-fitHRM(squamate.tree,fore_digits,umbral=TRUE,ncat=c(2,1,1,1,1,2),niter=10,
parallel=TRUE,ncores=10,pi="fitzjohn",ordered=TRUE,order=levels(fore_digits),
lik.func="pruning",logscale=TRUE)
plot(fingers_hrm)
plot(fingers_hrm,signif=6)
anova(fingers_mk,fingers_hrm)
ancr(fingers_mk)
ancr(fingers_hrm)
anova(fingers_mk,fingers_hrm)
anova(toes_mk,toes_hrm)
options(scipen=6)
plot(toes_mk,signif=4)
par()$usr
plot(toes_mk,signif=4,ylim=c(0,1))
plot(toes_mk,signif=4,ylim=c(-0.5,1))
plot(toes_mk,signif=4,ylim=c(-0.5,1),asp=0.5)
plot(toes_mk,signif=4,ylim=c(0,1),asp=0.6)
plot(toes_mk,signif=4,ylim=c(-0.5,1),asp=0.6)
plot(toes_mk,signif=4,ylim=c(-0.5,1),asp=0.7)
plot(toes_mk,signif=4,ylim=c(-0.6,1),asp=0.6)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.6)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.2)
plot(toes_mk,signif=4,ylim=c(-0.5,0.5),asp=0.2)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.2)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.4)
png(file="mk_rear_toes.png",width=6,height=6,units="in",res=300)
options(scipen=6)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.4)
dev.off()
png(file="mk_rear_toes.png",width=10,height=6,units="in",res=300)
options(scipen=6)
plot(toes_mk,signif=4,ylim=c(-1,1),asp=0.4)
dev.off()
png(file="mk_rear_toes-2.png",width=10,height=6,units="in",res=300)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE)
dev.off()
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,asp=0.6)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,asp=0.8)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,xlim=c(-2,1))
png(file="mk_rear_toes-2.png",width=10,height=6,units="in",res=300)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,xlim=c(-2,1))
dev.off()
png(file="mk_rear_toes-2.png",width=8,height=6,units="in",res=300)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,xlim=c(-2,1))
dev.off()
png(file="mk_rear_toes-2.png",width=12,height=8,units="in",res=300)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=4,
width=TRUE,color=TRUE,xlim=c(-1.8,1))
dev.off()
plot(toes_hrm)
plot(toes_hrm,asp=0.5)
plot(toes_hrm,asp=0.25)
plot(toes_hrm,asp=0.5)
plot(toes_hrm,asp=0.5,signif=4)
png(file="mk_rear_toes.png",width=10,height=6,units="in",res=300)
options(scipen=6)
plot(toes_mk,signif=5,ylim=c(-1,1),asp=0.4)
dev.off()
png(file="mk_rear_toes-2.png",width=12,height=8,units="in",res=300)
plot(as.Qmatrix(toes_mk),show.zeros=FALSE,signif=5,
width=TRUE,color=TRUE,xlim=c(-1.8,1))
dev.off()
plot(toes_hrm,asp=0.5,signif=5)
png(file="hrm_rear_toes.png",width=10,height=6,units="in",res=300)
plot(toes_hrm,asp=0.5,signif=5)
dev.off()
anova(toes_mk,toes_hrm)
h<-max(node)
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.1*h))
h<-max(node)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.1*h))
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-viridisLite::viridis(n=6)
cols
args(viridisLite::viridis)
cols<-viridisLite::viridis(n=6,direction=-1)
cols
cols<-setNames(viridisLite::viridis(n=6,direction=-1)
levels(hind_digits))
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
cols
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
i<-1
squamate.tree$tip.label[i]
hind_digits[squamate.tree$tip.label[i]]
cols[hind_digits[squamate.tree$tip.label[i]]]
i
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
summary(hind_digits)
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
toes_mk<-ancr(toes_mk)
nodelabels(pie=toes_mk$ace,piecol=cols,cex=0.5)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
toes_mk<-ancr(toes_mk)
toes_mk<-fitHRM(squamate.tree,hind_digits,umbral=TRUE,ncat=1,niter=10,
parallel=TRUE,ncores=10,pi="fitzjohn",ordered=TRUE,order=levels(hind_digits),
lik.func="pruning",logscale=TRUE)
anova(toes_mk,toes_hrm)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
toes_mk_asr<-ancr(toes_mk)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.4 else 0.2)
nodelabels(pie=toes_mk$ace,piecol=cols,cex=cex_pies)
par(fg="black")
head(cex_pies)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
toes_mk_asr<-ancr(toes_mk)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.4 else 0.2)
nodelabels(pie=toes_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
toes_mk_asr<-ancr(toes_mk)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=toes_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
png(file="mk_toes_asr.png",width=12,height=8,units="in",res=300)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="grey",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=toes_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
png(file="mk_toes_asr.png",width=12,height=8,units="in",res=300)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=toes_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=toes_hrm_asr$ace,piecol=cols,cex=cex_pies)
toes_hrm_asr<-ancr(toes_hrm)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(toes_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=toes_hrm_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
ancr(toes_hrm)
par(fg="black")
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(hide.hidden(toes_hrm_asr),1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=hide.hidden(toes_hrm_asr),piecol=cols,cex=cex_pies)
par(fg="black")
png(file="hrm_toes_asr.png",width=12,height=8,units="in",res=300)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(hide.hidden(toes_hrm_asr),1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=hide.hidden(toes_hrm_asr),piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
m
fingers_mk_asr<-ancr(fingers_mk)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(fingers_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=fingers_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
png(file="mk_fingers_asr.png",width=12,height=8,units="in",res=300)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(fingers_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=fingers_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
png(file="mk_fingers_asr.png",width=12,height=8,units="in",res=600)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(fingers_mk_asr$ace,1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=fingers_mk_asr$ace,piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
fingers_hrm_asr<-ancr(fingers_hrm)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(hide.hidden(fingers_hrm_asr),1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=hide.hidden(fingers_hrm_asr),piecol=cols,cex=cex_pies)
par(fg="black")
png(file="hrm_fingers_asr.png",width=12,height=8,units="in",res=300)
h<-max(nodeHeights(squamate.tree))
plotTree(squamate.tree,direction="upwards",ftype="off",lwd=1,
color="black",ylim=c(0,1.05*h))
pp<-get("last_plot.phylo",envir=.PlotPhyloEnv)
cols<-setNames(viridisLite::viridis(n=6,direction=-1),
levels(hind_digits))
for(i in 1:Ntip(squamate.tree)){
COL<-cols[hind_digits[squamate.tree$tip.label[i]]]
polygon(pp$xx[i]+c(-0.5,-0.5,0.5,0.5),
pp$yy[i]+c(0,0.05*h,0.05*h,0),
col=COL,border=FALSE)
}
legend("bottomleft",levels(hind_digits),pch=22,pt.bg=cols)
par(fg="transparent")
cex_pies<-apply(hide.hidden(fingers_hrm_asr),1,function(x) if(max(x>0.9)) 0.2 else 0.4)
nodelabels(pie=hide.hidden(fingers_hrm_asr),piecol=cols,cex=cex_pies)
par(fg="black")
dev.off()
save.image("C:/Users/Liam.Revell/Documents/GitHub/reptile-digit-evolution/workspace.RData")
